"0","library(tidyverse)"
"0","library(ggplot2)"
"0",""
"0","# Define observed odds ratio"
"0","observed_or <- 1.65"
"0",""
"0","# Define bias parameters"
"0","S00 <- 0.8"
"0","S01 <- c(0.5, 0.525, 0.55, 0.575, 0.6, 0.625, 0.65, 0.675, 0.7)"
"0","differences <- c(0, -0.05, -0.1) "
"0",""
"0","# Define function to calculate bias-adjusted odds ratio"
"0","calc_bias_adj_or <- function(or, s01, s10, s00, s11) {"
"0","  bias_adj_or <- or * (s01*s10)/(s00*s11)"
"0","  return(bias_adj_or)"
"0","}"
"0",""
"0","# Calculate bias-adjusted estimate for different values of bias parameters"
"0","results <- NULL"
"0","for (s01 in S01) {"
"0","  for (diff in differences) {"
"0","    bias_adj_or <- calc_bias_adj_or(observed_or, s01, S00 + diff, S00, s01 + diff)"
"0","    results_row <- tibble_row(bias_adj_or=bias_adj_or, s01=s01, diff=as.character(diff))"
"0","    results <- bind_rows(results, results_row)"
"0","  }"
"0","}"
"0",""
"0","results <- results %>% mutate(diff=factor(diff, levels=c(""0"", ""-0.05"", ""-0.1""), labels=c(""0"", ""-5%"", ""-10%"")))"
"0",""
"0","# Plot figure of bias-adjusted estimates"
"0","ggplot(data = results, aes(x=s01, y=bias_adj_or, colour=diff)) + "
"0","  geom_line() + "
"0","  theme_minimal() +"
"0","  ylim(1.4, 2) + "
"0","  scale_x_reverse() +"
"0","  xlab(""Selection probability of unexposed with cardiac malformations"") + "
"0","  ylab(""Bias-adjusted odds ratio"") +"
"0","  guides(colour=guide_legend(title=""Difference in selection\nprobability of exposed"")) +"
"0","  theme(legend.title=element_text(size=12))"
